<h1 class="text-2xl font-bold mb-6">Visitors</h1>

<div data-controller="analytics">
  <div>
    <label for="time_period">Select Time Period:</label>
    <select id="time_period" name="time_period" data-analytics-target="timePeriodSelect">
      <%= options_for_select(time_period_options, params[:time_period]) %>
    </select>
  </div>
  <div>
    <label for="group_period">Select Group Period:</label>
    <select id="group_period" name="group_period" data-analytics-target="groupPeriodSelect">
      <%= options_for_select(group_period_options, params[:group_period]) %>
    </select>
  </div>
</div>

<div id="chart-container">
  <%= line_chart @visitors_data %>
</div>

<h2 class="text-xl font-bold mt-6">Top Countries</h2>
<table class="table-auto w-full">
  <thead>
    <tr>
      <th>Country</th>
      <th>Visits</th>
    </tr>
  </thead>
  <tbody>
    <% @top_countries.each do |country, count| %>
      <tr>
        <td><%= country %></td>
        <td><%= count %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<h2 class="text-xl font-bold mt-6">Top Cities</h2>
<table class="table-auto w-full">
  <thead>
    <tr>
      <th>City</th>
      <th>Visits</th>
    </tr>
  </thead>
  <tbody>
    <% @top_cities.each do |city, count| %>
      <tr>
        <td><%= city %></td>
        <td><%= count %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<h2 class="text-xl font-bold mt-6">Top Device Types</h2>
<table class="table-auto w-full">
  <thead>
    <tr>
      <th>Device Type</th>
      <th>Visits</th>
    </tr>
  </thead>
  <tbody>
    <% @top_device_types.each do |device_type, count| %>
      <tr>
        <td><%= device_type %></td>
        <td><%= count %></td>
      </tr>
    <% end %>
  </tbody>
</table>
